<!-- app/views/products/_card.html.erb -->
<div class="col-md-3 mb-4">
  <div class="card h-100">
    <% if product.image&.attached? %>
      <%= image_tag product.image.variant(resize_to_limit: [400, 300]),
                    class: "card-img-top",
                    alt: "Image of #{product.name}" %>
    <% end %>
    <div class="card-body d-flex flex-column">
      <h5 class="card-title"><%= product.name %></h5>

      <% if product.on_sale %>
        <p class="card-text mb-2">
          <span class="text-decoration-line-through text-muted"><%= number_to_currency(product.price) %></span>
          <span class="fw-bold text-danger"><%= number_to_currency(product.sale_price) %></span>
        </p>
      <% else %>
        <p class="card-text text-muted mb-2"><%= number_to_currency(product.price) %></p>
      <% end %>

      <p class="card-text"><%= truncate(product.description.presence || "No description available", length: 80) %></p>

      <div class="mb-2">
        <% if product.on_sale %><span class="badge bg-danger me-1" aria-label="On Sale">On Sale</span><% end %>
        <% if product.created_at >= 3.days.ago %><span class="badge bg-success me-1" aria-label="New">New</span><% end %>
        <% if product.updated_at >= 3.days.ago %><span class="badge bg-info" aria-label="Updated">Updated</span><% end %>
      </div>

      <div class="mt-auto">
        <%= link_to "View", product_path(product), class: "btn btn-primary btn-sm" %>
      </div>
    </div>
  </div>
</div>
